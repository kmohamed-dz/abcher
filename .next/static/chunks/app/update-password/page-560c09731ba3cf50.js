(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[352],{269:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>x});var s=r(5155),a=r(8500),n=r.n(a),i=r(3321),l=r(2115),o=r(8434),d=r(4206),c=r(4426),u=r(3602);function m(e,t,r){let s,a=function(e,t){if(e instanceof Error&&e.message)return e.message;if("object"==typeof e&&null!==e&&"message"in e){let t=e.message;if("string"==typeof t&&t.trim())return t}return t}(t,r);console.warn(`[auth:${e}]`,a);let n=(s=a.toLowerCase()).includes("same password")?"اختر كلمة مرور جديدة مختلفة عن السابقة.":s.includes("password should be at least")?"كلمة المرور يجب أن تكون 6 أحرف على الأقل.":s.includes("expired")?"رابط إعادة التعيين منتهي الصلاحية. اطلب رابطًا جديدًا.":"تعذر تحديث كلمة المرور.";o.Ay.error(`${n} (${a})`)}let h=(0,r(7236).U)();function x(){let e=(0,i.useRouter)(),[t,r]=(0,l.useState)(!0),[a,x]=(0,l.useState)(!1),[b,f]=(0,l.useState)(!1),[p,g]=(0,l.useState)(""),[w,y]=(0,l.useState)(""),[j,N]=(0,l.useState)({});(0,l.useEffect)(()=>{(async()=>{r(!0);try{let e=new URLSearchParams(window.location.search),t=e.get("error_description"),r=e.get("code");if(t){o.Ay.error(`تعذر التحقق من الرابط. (${t})`),f(!1);return}if(r){let{error:e}=await h.auth.exchangeCodeForSession(r);if(e)throw e}let{data:{session:s},error:a}=await h.auth.getSession();if(a)throw a;if(!s){o.Ay.error("رابط الاستعادة غير صالح أو منتهي. اطلب رابطًا جديدًا."),f(!1);return}f(!0)}catch(e){m("update-password:init",e,"تعذر تهيئة صفحة التحديث."),f(!1)}finally{r(!1)}})()},[]);let v=(0,l.useMemo)(()=>t?"جارٍ التحقق من صلاحية رابط الاستعادة...":b?"أدخل كلمة مرور جديدة وآمنة لحسابك.":"يمكنك طلب رابط جديد من صفحة استعادة كلمة المرور.",[t,b]),A=async t=>{let r;if(t.preventDefault(),!b)return void o.Ay.error("الرابط غير صالح. اطلب رابط استعادة جديد.");if(r={},p?p.length<6&&(r.password="كلمة المرور يجب أن تكون 6 أحرف على الأقل."):r.password="كلمة المرور الجديدة مطلوبة.",w?w!==p&&(r.confirmPassword="كلمتا المرور غير متطابقتين."):r.confirmPassword="تأكيد كلمة المرور مطلوب.",N(r),0!==Object.keys(r).length)return void o.Ay.error("يرجى تصحيح أخطاء النموذج.");x(!0);try{let{error:t}=await h.auth.updateUser({password:p});if(t)throw t;await h.auth.signOut(),o.Ay.success("تم تحديث كلمة المرور بنجاح. يمكنك تسجيل الدخول الآن."),e.replace("/login")}catch(e){m("update-password:submit",e,"تعذر تحديث كلمة المرور.")}finally{x(!1)}};return t?(0,s.jsx)("section",{dir:"rtl",className:"flex min-h-screen items-center justify-center bg-app",children:(0,s.jsx)("div",{className:"h-11 w-11 animate-spin rounded-full border-4 border-primary-100 border-t-primary-600"})}):(0,s.jsx)(d.A,{title:"تحديث كلمة المرور",subtitle:v,footer:(0,s.jsxs)(s.Fragment,{children:["تذكرت كلمة المرور؟"," ",(0,s.jsx)(n(),{href:"/login",className:"font-semibold text-brand-700 hover:text-brand-600",children:"تسجيل الدخول"})]}),children:(0,s.jsxs)("form",{onSubmit:A,className:"space-y-4",dir:"rtl",children:[(0,s.jsx)(u.A,{id:"update-password",label:"كلمة المرور الجديدة",type:"password",value:p,onChange:g,error:j.password,disabled:!b}),(0,s.jsx)(u.A,{id:"update-confirm-password",label:"تأكيد كلمة المرور",type:"password",value:w,onChange:y,error:j.confirmPassword,disabled:!b}),(0,s.jsx)(c.A,{type:"submit",disabled:a||!b,children:a?"جارٍ التحديث...":"حفظ كلمة المرور"})]})})}},1337:(e,t,r)=>{"use strict";r.d(t,{A_:()=>d,Yq:()=>l,cn:()=>n,r6:()=>o});var s=r(9722),a=r(622);function n(...e){return(0,a.QP)((0,s.$)(e))}function i(e){return e instanceof Date?e:new Date(e)}function l(e){let t=i(e);return Number.isNaN(t.getTime())?"-":new Intl.DateTimeFormat("ar-DZ",{year:"numeric",month:"long",day:"numeric"}).format(t)}function o(e){let t=i(e);return Number.isNaN(t.getTime())?"-":new Intl.DateTimeFormat("ar-DZ",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(t)}let d=["المبتدئ","جزء عم","جزء تبارك","ثلث القرآن","نصف القرآن","ثلاثة أرباع القرآن","الحفظ الكامل"]},3321:(e,t,r)=>{"use strict";var s=r(4645);r.o(s,"useParams")&&r.d(t,{useParams:function(){return s.useParams}}),r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})},3602:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var s=r(5155),a=r(1337);function n({id:e,label:t,value:r,error:n,helper:i,onChange:l,className:o,...d}){return(0,s.jsxs)("div",{className:"space-y-1.5",children:[(0,s.jsx)("label",{htmlFor:e,className:"block text-sm font-semibold text-gray-700",children:t}),(0,s.jsx)("input",{id:e,value:r,onChange:e=>l(e.target.value),className:(0,a.cn)("min-h-[44px] w-full rounded-xl border border-gray-200 bg-white px-3 py-2 text-[16px] outline-none ring-brand-600/20 transition focus:ring",n?"border-red-300":"",o),...d}),n?(0,s.jsx)("p",{className:"text-sm text-red-600",children:n}):i?(0,s.jsx)("p",{className:"text-xs text-gray-500",children:i}):null]})}},4206:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var s=r(5155),a=r(8500),n=r.n(a),i=r(8992);function l({title:e,subtitle:t,children:r,footer:a}){return(0,s.jsx)("main",{dir:"rtl",className:"min-h-screen bg-app",children:(0,s.jsxs)("div",{className:"grid min-h-screen lg:grid-cols-2",children:[(0,s.jsx)("section",{className:"relative overflow-hidden bg-brand-600 bg-mosque-pattern p-6 text-white lg:p-10",children:(0,s.jsxs)("div",{className:"mx-auto flex h-full w-full max-w-xl flex-col justify-between",children:[(0,s.jsxs)("div",{className:"rounded-2xl bg-white/10 p-4 backdrop-blur-sm",children:[(0,s.jsx)("p",{className:"text-sm text-white/90",children:"منصة المدارس القرآنية"}),(0,s.jsx)("h2",{className:"mt-2 text-2xl font-extrabold",children:"إدارة مدرسية بطابع عربي واضح"})]}),(0,s.jsxs)("div",{className:"relative hidden h-64 lg:block",children:[(0,s.jsx)("div",{className:"absolute bottom-0 right-0 h-40 w-40 rounded-t-full border-2 border-white/25"}),(0,s.jsx)("div",{className:"absolute bottom-0 right-20 h-56 w-56 rounded-t-full border-2 border-white/20"}),(0,s.jsx)("div",{className:"absolute bottom-0 right-44 h-32 w-32 rounded-t-full border-2 border-white/20"}),(0,s.jsx)("div",{className:"absolute bottom-0 left-12 h-20 w-16 rounded-t-full bg-white/10"}),(0,s.jsx)("div",{className:"absolute bottom-20 left-[5.25rem] h-8 w-2 bg-white/30"})]})]})}),(0,s.jsxs)("section",{className:"relative flex items-center justify-center px-4 py-8 md:px-8",children:[(0,s.jsx)(n(),{href:"/",className:"absolute right-6 top-6 text-xl font-extrabold text-brand-700",children:"أبشر"}),(0,s.jsxs)(i.A,{className:"w-full max-w-[480px] bg-[#FFFCF7] p-6 md:p-8",children:[(0,s.jsxs)("header",{className:"mb-6 space-y-2 text-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-extrabold text-brand-700 md:text-3xl",children:e}),t?(0,s.jsx)("p",{className:"text-sm leading-7 text-gray-600",children:t}):null]}),(0,s.jsx)("div",{className:"space-y-4",children:r}),a?(0,s.jsx)("footer",{className:"mt-6 text-center text-sm text-gray-600",children:a}):null]})]})]})})}},4426:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var s=r(5155),a=r(1337);let n={primary:"bg-brand-600 text-white hover:bg-brand-700",secondary:"bg-white text-brand-700 border border-brand-600 hover:bg-primary-50",danger:"bg-red-600 text-white hover:bg-red-700"};function i({variant:e="primary",className:t,type:r="button",...i}){return(0,s.jsx)("button",{type:r,className:(0,a.cn)("inline-flex min-h-[44px] w-full items-center justify-center rounded-lg px-4 py-2 text-sm font-semibold transition disabled:cursor-not-allowed disabled:opacity-60",n[e],t),...i})}},7236:(e,t,r)=>{"use strict";r.d(t,{U:()=>a});var s=r(6622);function a(){return(0,s.createBrowserClient)("https://zuppzhysrgmioyozrltp.supabase.co","sb_publishable_GQkKFgomb7ThK_H_csmdoQ_CYQOschE")}},7757:(e,t,r)=>{Promise.resolve().then(r.bind(r,269))},8992:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var s=r(5155),a=r(1337);function n({className:e,...t}){return(0,s.jsx)("div",{className:(0,a.cn)("rounded-3xl bg-white p-6 shadow-card",e),...t})}}},e=>{e.O(0,[143,500,409,441,794,358],()=>e(e.s=7757)),_N_E=e.O()}]);